{
    "$schema": "https://json-schema.org/draft/2019-09/schema",
    "$id": "https://canonical.github.io/charm-relation-interfaces/interfaces/database_backup_manager/schemas/provider.json",
    "title": "`database_backup_manager` provider schema",
    "description": "The `database_backup_manager` root schema comprises the entire provider databag for this interface.",
    "type": "object",
    "default": {},
    "required": [
        "job-id",
        "job-type",
        "status",
        "storage-interface-type",
        "storage-interface-data"
    ],
    "additionalProperties": true,
    "properties": {
        "job-id": {
            "$id": "#/properties/job-id",
            "title": "Job ID",
            "description": "A unique id for the job. Is the same value as the one provided by the Requirer.",
            "type": "string",
            "examples": [
                "job-01693ed2-644f-11ed-81ce-0242ac120002"
            ]
        },
        "job-type": {
            "$id": "#/properties/job-type",
            "title": "Job type",
            "description": "The job type. Is the same value as the one provided by the Requirer.",
            "type": "string",
            "enum": ["backup", "restore"],
            "default": "backup"
        },
        "status": {
            "$id": "#/properties/status",
            "title": "Job status",
            "description": "The status of the job once it has completed",
            "type": "string",
            "enum": ["running", "success", "error"]
        },
        "storage-interface-type": {
            "$id": "#/properties/storage-interface-type",
            "title": "Storage interface type",
            "description": "The storage interface to use for storing or retrieving files",
            "type": "string",
            "enum": ["s3"],
            "default": "s3"
        },
        "storage-interface-data": {
            "type": "object",
            "required": [
                "s3-access-key",
                "s3-secret-key",
                "s3-log-file"
            ],
            "properties": {
                "s3-access-key": {
                    "$id": "#/properties/storage-interface-data/s3-access-key",
                    "title": "S3 Access Key",
                    "description": "The S3 access key with which to access the S3 bucket with",
                    "type": "string",
                    "examples": [
                        "access-key"
                    ]
                },
                "s3-secret-key": {
                    "$id": "#/properties/storage-interface-data/s3-secret-key",
                    "title": "S3 Secret Key",
                    "description": "The S3 secret key with which to access the S3 bucket with",
                    "type": "string",
                    "examples": [
                        "secret-key"
                    ]
                },
                "s3-log-file": {
                    "$id": "#/properties/storage-interface-data/s3-log-file",
                    "title": "S3 file path",
                    "description": "Path where the job is expected to upload a log file to",
                    "type": "string",
                    "examples": [
                        "s3://bucket/mysql/2022-01-01T01:01:01.123456/logs/backup.log"
                    ]
                },
                "s3-backup-file": {
                    "$id": "#/properties/storage-interface-data/s3-backup-file",
                    "title": "Backup file path",
                    "description": "Path where the job is expected to upload the backup file",
                    "type": "string",
                    "examples": [
                        "s3://bucket/mysql/2022-01-01T01:01:01.123456/backups/mysql.backup"
                    ]
                },
                "s3-restore-file": {
                    "$id": "#/properties/storage-interface-data/s3-restore-file",
                    "title": "Restore file path",
                    "description": "Path where the job is expected to retrieve the restore file",
                    "type": "string",
                    "examples": [
                        "s3://bucket/mysql/2022-01-01T01:01:01.123456/backups/mysql.backup"
                    ]
                }
            }
        }
    },
    "examples": [
        {
            "job-id": "job-01693ed2-644f-11ed-81ce-0242ac120002",
            "job-type": "backup",
            "status": "success",
            "storage-interface-type": "s3",
            "storage-interface-data": {
                "s3-access-key": "access-key",
                "s3-secret-key": "secret-key",
                "s3-log-file": "s3://bucket/mysql/2022-01-01T01:01:01.123456/logs/backup.log",
                "s3-backup-file": "s3://bucket/mysql/2022-01-01T01:01:01.123456/backups/mysql.backup"
            }
        },
        {
            "job-id": "job-d0e6d45c-6450-11ed-81ce-0242ac120002",
            "job-type": "restore",
            "status": "failure",
            "storage-interface-type": "s3",
            "storage-interface-data": {
                "s3-access-key": "access-key",
                "s3-secret-key": "secret-key",
                "s3-log-file": "s3://bucket/mysql/2023-01-01T01:01:01.123456/logs/restore.log",
                "s3-restore-file": "s3://bucket/mysql/2022-01-01T01:01:01.123456/backups/mysql.backup"
            }
        }
    ]
}
