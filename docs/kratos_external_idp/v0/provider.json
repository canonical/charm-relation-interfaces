{
    "title": "Kratos external idp provider schema",
    "description": "The `kratos_external_idp` root schema comprises the entire provider databag for this interface.",
    "type": "object",
    "properties": {
      "unit": {
        "$ref": "#/definitions/BaseModel"
      },
      "app": {
        "$ref": "#/definitions/KratosExternalIdpRequirerSchema"
      }
    },
    "required": [
      "app"
    ],
    "definitions": {
        "BaseModel": {
            "title": "BaseModel",
            "type": "object",
            "properties": {}
        },
        "KratosExternalIdpRequirerSchema": {
            "title": "BaseModel",
            "type": "object",
            "properties": {
                "providers": {
                    "type": "array",
                    "items": {
                        "anyOf": [
                            {
                                "type": "object",
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "tenant_id",
                                    "provider"
                                ],
                                "properties": {
                                    "client_id": {"$ref": "/schemas/client_id"},
                                    "client_secret": {"$ref": "/schemas/client_secret"},
                                    "secret_backend": {"$ref": "/schemas/secret_backend"},
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "tenant_id": {
                                        "title": "The Azure AD tenant_id which the users belong to",
                                        "description": "The Azure AD tenant_id which the users belong to",
                                        "type": "string"
                                    },
                                    "provider": {"enum": ["microsoft"]}
                                },
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "required": [
                                    "client_id",
                                    "private_key",
                                    "private_key_id",
                                    "secret_backend",
                                    "team_id",
                                    "provider"
                                ],
                                "properties": {
                                    "client_id": {"$ref": "/schemas/client_id"},
                                    "private_key": {
                                        "title": "The private key generated by Apple",
                                        "description": "The private key generated by Apple",
                                        "type": "string"
                                    },
                                    "private_key_id": {
                                        "title": "The private key identifier generated by Apple",
                                        "description": "The private key identifier generated by Apple",
                                        "type": "string"
                                    },
                                    "secret_backend": {"$ref": "/schemas/secret_backend"},
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "team_id": {
                                        "title": "The Team ID provided by Apple",
                                        "description": "The Team ID provided by Apple",
                                        "type": "string"
                                    },
                                    "provider": {"enum": ["apple"]}
                                },
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "issuer_url": {
                                        "$ref": "/schemas/issuer_url"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["generic"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "issuer_url",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "issuer_url": {
                                        "$ref": "/schemas/issuer_url"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["auth0"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "issuer_url",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["google"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["facebook"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["github"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["gitlab"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["slack"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["spotify"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["discord"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["twitch"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["netid"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["yandex"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["vk"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            },
                            {
                                "type": "object",
                                "properties": {
                                    "client_id": {
                                        "$ref": "/schemas/client_id"
                                    },
                                    "client_secret": {
                                        "$ref": "/schemas/client_secret"
                                    },
                                    "secret_backend": {
                                        "$ref": "/schemas/secret_backend"
                                    },
                                    "scope": {"$ref": "/schemas/scope"},
                                    "provider_id": {"$ref": "/schemas/provider_id"},
                                    "jsonnet": {"$ref": "/schemas/jsonnet"},
                                    "provider": {"enum": ["dingtalk"]}
                                },
                                "required": [
                                    "client_id",
                                    "client_secret",
                                    "secret_backend",
                                    "provider"
                                ],
                                "additionalProperties": true
                            }
                        ]
                    }
                }
            }
        }
    },
    "$defs": {
        "client_id": {
            "$id": "/schemas/client_id",
            "title": "The client_id for the Kratos client",
            "description": "The registered client_id that will be used by Kratos to authenticate with the external idp",
            "type": "string",
            "examples": [
                "some_random_string"
            ]
        },
        "client_secret": {
            "$id": "/schemas/client_secret",
            "title": "The client_secret for the Kratos client",
            "description": "The registered client_secret that will be used by Kratos to authenticate with the external idp",
            "type": "string",
            "examples": [
                "h4ckerz"
            ]
        },
        "issuer_url": {
            "$id": "/schemas/issuer_url",
            "title": "The external provider's issuer_url",
            "description": "The external provider's issuer_url",
            "type": "string",
            "examples": [
                "https://example.com/oidc"
            ]
        },
        "scope": {
            "$id": "/schemas/scope",
            "title": "The external provider's allowed scopes",
            "description": "A space separated list with he external provider's allowed scope. `openid` is added implicitly",
            "type": "string",
            "default": "profile email address phone",
            "examples": [
                "profile email address"
            ]
        },
        "secret_backend": {
            "$id": "/schemas/secret_backend",
            "title": "Where the secrets are stored",
            "description": "Where the secrets are stored",
            "type": "string",
            "default": "relation",
            "enum": [
                "relation",
                "secret",
                "vault"
            ],
            "examples": [
                "relation"
            ]
        },
        "provider_id": {
            "$id": "/schemas/provider_id",
            "title": "The ID for the provider that will be used by kratos",
            "description": "The ID for the provider that will be used by kratos",
            "type": "string",
            "examples": [
                "Microsoft"
            ]
        },
        "jsonnet": {
            "$id": "/schemas/jsonnet",
            "title": "The jsonnet that will be used for transforming the external provider's claims",
            "description": "The jsonnet that will be used for transforming the external provider's claims",
            "type": "string"
        }
    }
}